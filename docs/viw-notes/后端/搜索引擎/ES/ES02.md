<!-- TOC -->

- [从零开始搭建ES](#从零开始搭建es)
    - [单机和集群](#单机和集群)
        - [单机](#单机)
- [集群名称 默认elasticsearch](#集群名称-默认elasticsearch)
- [集群名称 默认elasticsearch](#集群名称-默认elasticsearch)
- [节点名称](#节点名称)
- [地址](#地址)
- [端口](#端口)
- [主节点名称](#主节点名称)
        - [集群](#集群)
            - [配置](#配置)
- [集群名称 默认elasticsearch](#集群名称-默认elasticsearch)
- [节点名称 每个节点的名称不能重复](#节点名称-每个节点的名称不能重复)
- [主节点名称](#主节点名称)
- [ip 地址， 每个节点的地址不能重复](#ip-地址-每个节点的地址不能重复)
- [是不是有资格主节点](#是不是有资格主节点)
- [head 插件需要这打开这两个配置](#head-插件需要这打开这两个配置)
- [es7.x 之后新增的配置， 初始化一个新的集群时需要此配置来选举 master](#es7x-之后新增的配置-初始化一个新的集群时需要此配置来选举-master)
- [es7.x 之后新增的配置，节点发现](#es7x-之后新增的配置节点发现)
- [集群内同时启动的数据任务个数，默认是2 个](#集群内同时启动的数据任务个数默认是2-个)
- [添加或删除节点及负载均衡时并发恢复的线程个数，默认4个](#添加或删除节点及负载均衡时并发恢复的线程个数默认4个)
- [初始化数据恢复时，并发恢复线程的个数，默认4个](#初始化数据恢复时并发恢复线程的个数默认4个)
- [配置es的集群名称，默认是elasticsearch，es会自动发现在同一网段下的es，如果在同一网段下有多个集群，就可以用这个属性来区分不同的集群](#配置es的集群名称默认是elasticsearches会自动发现在同一网段下的es如果在同一网段下有多个集群就可以用这个属性来区分不同的集群)
- [节点名，默认随机指定一个name列表中名字，该列表在es的jar包中config文件夹里name.txt文件中，其中有很多作者添加的有趣名字](#节点名默认随机指定一个name列表中名字该列表在es的jar包中config文件夹里nametxt文件中其中有很多作者添加的有趣名字)
- [指定该节点是否有资格被选举成为node，默认是true，es是默认集群中的第一台机器为master，如果这台机挂了就会重新选举master。](#指定该节点是否有资格被选举成为node默认是truees是默认集群中的第一台机器为master如果这台机挂了就会重新选举master)
- [指定该节点是否存储索引数据，默认为trues](#指定该节点是否存储索引数据默认为trues)
- [设置索引数据的存储路径，默认是es根目录下的data文件夹，可以设置多个存储路径，用逗号隔开](#设置索引数据的存储路径默认是es根目录下的data文件夹可以设置多个存储路径用逗号隔开)
- [设置日志文件的存储路径，默认是es根目录下的logs文件夹](#设置日志文件的存储路径默认是es根目录下的logs文件夹)
- [节点通信ip](#节点通信ip)
- [设置对外服务的http端口，默认为9200](#设置对外服务的http端口默认为9200)
- [设置内容的最大容量，默认100mb](#设置内容的最大容量默认100mb)
- [是否使用http协议对外提供服务，默认为true，开启](#是否使用http协议对外提供服务默认为true开启)
- [# 增加新的参数，这样head插件可以访问es](#-增加新的参数这样head插件可以访问es)
- [设置节点间交互的tcp端口，默认是9300](#设置节点间交互的tcp端口默认是9300)
- [设置是否压缩tcp传输时的数据，默认为false，不压缩。](#设置是否压缩tcp传输时的数据默认为false不压缩)
- [设置集群中master节点的初始列表，可以通过这些节点来自动发现新加入集群的节点](#设置集群中master节点的初始列表可以通过这些节点来自动发现新加入集群的节点)
- [设置这个参数来保证集群中的节点可以知道其它N个有master资格的节点。默认为1，对于大的集群来说，可以设置大一点的值（2-4）](#设置这个参数来保证集群中的节点可以知道其它n个有master资格的节点默认为1对于大的集群来说可以设置大一点的值2-4)
- [为了避免脑裂，集群节点数最少为 半数+1](#为了避免脑裂集群节点数最少为-半数1)
- [这个设置使删除只限于特定名称指向的数据，而不允许通过指定all 或通配符来删除指定索引库](#这个设置使删除只限于特定名称指向的数据而不允许通过指定all-或通配符来删除指定索引库)
- [再一次理解ES的概念](#再一次理解es的概念)

<!-- /TOC -->



# 从零开始搭建ES


## 单机和集群

> ES集群
### 单机

> mac下 在 前面已经有了，其他搜索下就可以了


**修改elastsearch.yml配置**


```yml
#集群名称 默认elasticsearch
cluster.name: elasticsearch
# 节点名称
node.name: node-1
# 地址
network.host: 0.0.0.0
# 端口
http.port: 9200
# 主节点名称
cluster.initial_master_nodes: ["node-1"]

```



### 集群

> es一般都是集群使用，不会有单节点的情况，分别在不同的节点执行



#### 配置

**集群配置**


![](https://xiaoboblog-bucket.oss-cn-hangzhou.aliyuncs.com/blog/20220123002308.png)


```yml


#集群名称 默认elasticsearch
cluster.name: elasticsearch
# 节点名称 每个节点的名称不能重复
node.name: node-1
# 主节点名称
cluster.initial_master_nodes: ["node-1"]
#  ip 地址， 每个节点的地址不能重复
network.host: node_host1
# 是不是有资格主节点
node.master: true
node.data: true
http.port: 9200
# head 插件需要这打开这两个配置
http.cors.allow-origin: "*"
http.cors.enabled: true
http.max_content_length: 200mb
#es7.x 之后新增的配置， 初始化一个新的集群时需要此配置来选举 master
cluster.initial_master_nodes: ["node-1"]
#es7.x 之后新增的配置，节点发现
discovery.seed_hosts: ["node_host1:9300","node_host2:9300","node_host3:9300"]
gateway.recover_after_nodes: 2
network.tcp.keep_alive: true
network.tcp.no_delay: true
transport.tcp.compress: true
#集群内同时启动的数据任务个数，默认是2 个
cluster.routing.allocation.cluster_concurrent_rebalance: 16
# 添加或删除节点及负载均衡时并发恢复的线程个数，默认4个
cluster.routing.allocation.node_concurrent_recoveries: 16
# 初始化数据恢复时，并发恢复线程的个数，默认4个
cluster.routing.allocation.node_initial_primaries_recoveries: 16

```

**其余项配置**


```yml


# 配置es的集群名称，默认是elasticsearch，es会自动发现在同一网段下的es，如果在同一网段下有多个集群，就可以用这个属性来区分不同的集群
cluster.name: jht-elas
# 节点名，默认随机指定一个name列表中名字，该列表在es的jar包中config文件夹里name.txt文件中，其中有很多作者添加的有趣名字
node.name: park-elasticsearch1
# 指定该节点是否有资格被选举成为node，默认是true，es是默认集群中的第一台机器为master，如果这台机挂了就会重新选举master。
node.master: true
# 指定该节点是否存储索引数据，默认为trues
node.data: true
node.attr.rack: r62
# 设置索引数据的存储路径，默认是es根目录下的data文件夹，可以设置多个存储路径，用逗号隔开
path.data: /home/park/elastic/data
# 设置日志文件的存储路径，默认是es根目录下的logs文件夹
path.logs: /home/park/elastic/logs
bootstrap.memory_lock: true
bootstrap.system_call_filter: false
# 节点通信ip
network.host: host
# 设置对外服务的http端口，默认为9200
http.port: 9200
# 设置内容的最大容量，默认100mb
http.max_content_length: 100mb
# 是否使用http协议对外提供服务，默认为true，开启
http.enabled: true
# # 增加新的参数，这样head插件可以访问es
http.cors.enabled: true
http.cors.allow-origin: "*"
# 设置节点间交互的tcp端口，默认是9300
transport.tcp.port: 9300
# 设置是否压缩tcp传输时的数据，默认为false，不压缩。
transport.tcp.compress: true
# 设置集群中master节点的初始列表，可以通过这些节点来自动发现新加入集群的节点
discovery.zen.ping.unicast.hosts: ["host1:8300", "host2:8300", "host3:8300"]
# 设置这个参数来保证集群中的节点可以知道其它N个有master资格的节点。默认为1，对于大的集群来说，可以设置大一点的值（2-4）
# 为了避免脑裂，集群节点数最少为 半数+1
discovery.zen.minimum_master_nodes: 3
# 这个设置使删除只限于特定名称指向的数据，而不允许通过指定_all 或通配符来删除指定索引库
action.destructive_requires_name: true
thread_pool.bulk.size: 3
thread_pool.bulk.queue_size: 1000
thread_pool.index.size: 3
thread_pool.index.queue_size: 1000


```




# 再一次理解ES的概念








